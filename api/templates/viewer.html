<!DOCTYPE html>
<html lang="it">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>{{ pdf_name | replace('.pdf', '') | replace('_', ' ') | title }}</title>
    <style>
        body { font-family: Arial, sans-serif; padding: 10px 10px 40px; background: #f8f9fa; margin: 0; }
        h1 { color: #333; font-size: 22px; margin: 8px 0 4px; }
        a { text-decoration: none; color: #007bff; font-size: 15px; }
        a:hover { text-decoration: underline; }
        .toolbar {
            display: flex; justify-content: center; align-items: center; gap: 10px;
            margin: 10px 0 16px; position: sticky; top: 0; background: #f8f9fa;
            padding: 8px; z-index: 10;
        }
        .toolbar input { width: 60px; padding: 6px; font-size: 16px; text-align: center; border: 1px solid #ccc; border-radius: 6px; }
        .toolbar button { background: #007bff; border: none; color: white; padding: 8px 14px; border-radius: 6px; font-size: 16px; cursor: pointer; }
        .toolbar button:hover { background: #0056b3; }
        img { display: block; max-width: 100%; margin: 12px auto; border-radius: 4px; }
    </style>
</head>
<body>
    <a href="/">← Torna all'elenco</a>
    <h1>{{ pdf_name | replace('.pdf', '') | replace('_', ' ') | title }}</h1>

    <div class="toolbar">
        <button id="prevBtn">◀</button>
        <span>Pag.</span>
        <input type="number" id="pageInput" min="1" value="1">
        <span>/ {{ images|length }}</span>
        <button id="nextBtn">▶</button>
    </div>

    {% for img in images %}
        <img src="{{ url_for('serve_image', folder=pdf_name, filename=img) }}"
             alt="Pagina {{ loop.index }}"
             id="page-{{ loop.index }}"
             loading="lazy"
             decoding="async">
    {% endfor %}

    <script>
        var totalPages = {{ images|length }};
        var pageInput = document.getElementById('pageInput');

        function scrollToPage(num) {
            var page = document.getElementById('page-' + num);
            if (page) { page.scrollIntoView({ block: 'start' }); pageInput.value = num; }
        }

        document.getElementById('prevBtn').addEventListener('click', function() {
            var c = parseInt(pageInput.value);
            if (c > 1) scrollToPage(c - 1);
        });

        document.getElementById('nextBtn').addEventListener('click', function() {
            var c = parseInt(pageInput.value);
            if (c < totalPages) scrollToPage(c + 1);
        });

        pageInput.addEventListener('change', function() {
            var v = parseInt(pageInput.value);
            if (v >= 1 && v <= totalPages) scrollToPage(v);
        });
    </script>
</body>
</html>
